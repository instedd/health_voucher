%h1 Reports

= render partial: 'shared/reports_tabs'

%h2 AGEP IDs per site

.tablewrapp
  %table.GralTable.report-table
    %colgroup
    %tbody
      %tr
        %th Site
        %th.number Total AGEP IDs
        %th.number with assigned card
        %th.number without card
      - if @data.empty?
        %tr
          %td(colspan="4") No sites registered.
      - else
        - @data.each do |row|
          %tr
            %td= row[:name]
            %td.number
              = row[:patient_count]
              %span.percentage= percent_of(row, @totals, :patient_count)
            %td.number
              = row[:patients_with_card]
              %span.percentage= percent_of(row[:patients_with_card], row[:patient_count])
            %td.number
              = row[:patients_without_card]
              %span.percentage= percent_of(row[:patients_without_card], row[:patient_count])

        %tr.totals
          %td Totals
          %td.number
            = @totals[:patient_count]
            %span.percentage 100.00%
          %td.number
            = @totals[:patients_with_card]
            %span.percentage= percent_of(@totals[:patients_with_card], @totals[:patient_count])
          %td.number
            = @totals[:patients_without_card]
            %span.percentage= percent_of(@totals[:patients_without_card], @totals[:patient_count])
